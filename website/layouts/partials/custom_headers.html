{{ $ccCss := "" }}
{{ if fileExists "node_modules/vanilla-cookieconsent/dist/cookieconsent.css" }}
  {{ $ccCss = readFile "node_modules/vanilla-cookieconsent/dist/cookieconsent.css" }}
{{ end }}
{{ $analytics := resources.Get "js/konflux-analytics/entry.js" | js.Build (dict
  "targetPath" "js/konflux-analytics.js"
  "format" "esm"
  "params" (dict
    "gaId" (getenv "GA_MEASUREMENT_ID")
    "amplitudeKey" (getenv "AMPLITUDE_API_KEY")
    "privacyUrl" (.Site.Params.privacy_policy_url)
    "debug" (hugo.IsServer)
    "cookieconsentCss" $ccCss
  )
) }}
<script src="{{ $analytics.RelPermalink }}" type="module"></script>
